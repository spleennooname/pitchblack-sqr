var _0x21b6=["fps","addEventListener","resize","render","draw","toDataURL","image/jpeg","userAgent","indexOf","chrome","getFullYear","getDate","getHours","getMinutes","getSeconds","createElement","href","download","click","scaling","readyState","HAVE_ENOUGH_DATA","bind","use","THRESHOLD","soft","uTexture","canvas","width","height","post","WEIGHT","weight","DECAY_FACTOR","decay","DENSITY","begin","then","end","innerWidth","innerHeight","videoWidth","videoHeight","postFBO","size","devicePixelRatio","projection","ProjectionMatrix","#ifdef GL_ES\nprecision highp float;\n#endif\n\nattribute vec2 aPosition;\nattribute vec2 aUV;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vUV = aUV;\n}\n\n//#fragment\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D uTexture;\n\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n//thresold\n//https://www.shadertoy.com/view/4ssGR8\n\nuniform float SOFT;\nuniform float THRESHOLD;\nuniform bool INVERT;\n\n#define luma(r,g,b) ( 0.2126 * r + 0.7152 * g + 0.0722 * b )\n\nvoid main(){\n\n  vec2 uv = vUV;\n  vec4 tx = texture2D(uTexture, uv);\n\n  float lum = luma(tx.r, tx.g, tx.b);\n\n  vec3 c = vec3(1.0);\n\n  if ( INVERT == false)\n      c -= smoothstep( THRESHOLD+SOFT, THRESHOLD-SOFT, lum);\n  else\n      c -= smoothstep( THRESHOLD+SOFT, THRESHOLD+SOFT, lum);\n\n  gl_FragColor = vec4(c, 1.0);\n\n}\n","#ifdef GL_ES\nprecision mediump float;\n#endif\n\nattribute vec2 aPosition;\nattribute vec2 aUV;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vUV = aUV;\n}\n\n//#fragment\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform sampler2D uTexture;\nuniform float uTime;\n\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n//godray\n//https://www.shadertoy.com/view/4ssGR8\n\n//#define DECAY_FACTOR 0.75\n#define EXPOSURE 0.21\n//#define DENSITY 0.85\n//#define WEIGHT 0.58\n\n#define NUM_SAMPLES 25\n\nuniform float WEIGHT;\nuniform float DECAY_FACTOR;\nuniform float DENSITY;\n\n\nfloat rand(float n){return fract(sin(n) * 43758.5453123);}\n\nfloat rand(vec2 n) {\n\treturn fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\n\nfloat noise(float p){\n\tfloat fl = floor(p);\n  float fc = fract(p);\n\treturn mix(rand(fl), rand(fl + 1.0), fc);\n}\n\nfloat noise(vec2 n) {\n\tconst vec2 d = vec2(0.0, 1.0);\n  vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n}\n\n// float noise_v2(vec2 n) {\n// \tconst vec2 d = vec2(0.0, 1.0);\n//   vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n// \treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n// }\n\nvoid main(){\n\n  vec2 uv = vUV;\n  vec2 tc = uv;\n  vec2 delta_tc = uv;\n\n  float t = uTime;\n\n  t *= 0.0018;\n\n  delta_tc = uv + vec2( sin( t*.3)*.3, -cos(t*.2)*.3 ) - .5;\n  delta_tc *= 1.0 / float(NUM_SAMPLES) * DENSITY;\n\n  float illumination_decay = 0.95;\n  vec4 color = texture2D(uTexture, tc) ;\n  vec4 sample_tx;\n\n  tc += delta_tc * fract( sin( dot( uv.xy + fract( tc ), vec2(42.9898, 50.233) ) ) * 43758.5453 );\n\n  for(int i=0; i < NUM_SAMPLES; i++) {\n    tc -= delta_tc;\n    sample_tx = texture2D(uTexture, tc ) * illumination_decay * WEIGHT;\n    //sample_tx *= illumination_decay * WEIGHT;\n    color += sample_tx * tc.y;//noise( vec2(tc.y, tc.x) ) ;\n    illumination_decay *= DECAY_FACTOR ;\n  }\n\n  vec4 c = color;\n\n  gl_FragColor = c * EXPOSURE;\n\n}\n","exports","defineProperty","__esModule","default","hasOwnProperty","call","#ui","run","mediaDevices","getUserMedia","show","constraints","hasCam","catch","fail","noSupport","Loader","loadAssets","webcam","video","loop","muted","Renderer","clearColor","rawFBO","FrameBuffer","thresoldFBO","createPostEffect","godrays","thresold","Primitives","threshold","camera","position","root","add","texture","Texture","renderer","LINEAR","context","shader","Shader","GLSL","setUniform","plane","buffer","createPlane","update","rotation","scene","stats","body","isTouch","ontouchstart","touchmove","mousemove","gui","addFolder","rays","params","density","open","black & white","invert","quality","step","onChange","set_quality","now"];!function(x,t){!function(t){for(;--t;)x.push(x.shift())}(++t)}(_0x21b6,290);var _0x621b=function(x,t){return x-=0,_0x21b6[x]};!function(x){function t(e){if(n[e])return n[e][_0x621b("0x0")];var i=n[e]={i:e,l:![],exports:{}};return x[e].call(i.exports,i,i.exports,t),i.l=!![],i.exports}var n={};t.m=x,t.c=n,t.d=function(x,n,e){t.o(x,n)||Object[_0x621b("0x1")](x,n,{configurable:![],enumerable:!![],get:e})},t.n=function(x){var n=x&&x[_0x621b("0x2")]?function(){return x[_0x621b("0x3")]}:function(){return x};return t.d(n,"a",n),n},t.o=function(x,t){return Object.prototype[_0x621b("0x4")][_0x621b("0x5")](x,t)},t.p="",t(t.s=0)}([function(x,t,n){x.exports=n(1)},function(x,t,n){"use strict";n(2),n(3),n(4),n(5)},function(x,t){},function(x,t){},function(x,t){},function(x,t,n){"use strict";var e={threshold:n(6),godrays:n(7)};new Vue({el:_0x621b("0x6"),data:{show:1,hud:0,isTouch:![],noSupport:![],scaling:1,params:{weight:.75,decay:.9,density:.85,quality:2.75,samples:20,threshold:.45,invert:![],soft:.001}},mounted:function(){this.$nextTick(this[_0x621b("0x7")])},methods:{hasCam:function(){return!!navigator.getUserMedia||!(!navigator[_0x621b("0x8")]||!navigator[_0x621b("0x8")][_0x621b("0x9")])},run:function(){this[_0x621b("0xa")]=0,this[_0x621b("0xb")]={video:{mandatory:{minAspectRatio:1.25,maxAspectRatio:1.6},optional:[{minWidth:640},{minHeight:480},{maxWidth:960},{maxHeight:720}]}},this[_0x621b("0xc")]()?navigator[_0x621b("0x8")][_0x621b("0x9")](this.constraints).then(this.done)[_0x621b("0xd")](this[_0x621b("0xe")]):this[_0x621b("0xf")]=!![]},fail:function(){this[_0x621b("0xf")]=!![]},done:function(x){SQR[_0x621b("0x10")][_0x621b("0x11")]([_0x621b("0x12")],this.onload)},onload:function(x){this[_0x621b("0x13")]=x[_0x621b("0x12")],this[_0x621b("0x13")][_0x621b("0x14")]=!![],this[_0x621b("0x13")][_0x621b("0x15")]=!![],this.renderer=SQR[_0x621b("0x16")]("#gl",{antialias:!![]})[_0x621b("0x17")](0,0,0,1),this[_0x621b("0x18")]=SQR.FrameBuffer(),this.postFBO=SQR[_0x621b("0x19")](),this[_0x621b("0x1a")]=SQR.FrameBuffer(),this.post=SQR.Primitives[_0x621b("0x1b")](e[_0x621b("0x1c")]),this[_0x621b("0x1d")]=SQR[_0x621b("0x1e")][_0x621b("0x1b")](e[_0x621b("0x1f")]),this[_0x621b("0x20")]=SQR.Transform(),this.camera[_0x621b("0x21")].z=2.5,this[_0x621b("0x22")]=SQR.Transform(),this[_0x621b("0x22")][_0x621b("0x23")](this.camera),this[_0x621b("0x24")]=SQR[_0x621b("0x25")](this[_0x621b("0x13")],{isAnimated:!![],minFilter:this[_0x621b("0x26")].context.gl[_0x621b("0x27")],magFilter:this[_0x621b("0x26")][_0x621b("0x28")].gl[_0x621b("0x27")]}),this[_0x621b("0x29")]=SQR[_0x621b("0x2a")](SQR[_0x621b("0x2b")][_0x621b("0x24")]).use()[_0x621b("0x2c")]("uTexture",this[_0x621b("0x24")]),this[_0x621b("0x2d")]=SQR.Transform(),this[_0x621b("0x2d")][_0x621b("0x2e")]=SQR.Primitives[_0x621b("0x2f")](4,3,2,2,0,0)[_0x621b("0x30")](),this.plane[_0x621b("0x31")].x=Math.PI/2,this[_0x621b("0x2d")][_0x621b("0x29")]=this[_0x621b("0x29")],this.root[_0x621b("0x23")](this.plane),this[_0x621b("0x32")]()},scene:function(x){this.hud=1,this[_0x621b("0xa")]=0,this[_0x621b("0x33")]=new Stats,this[_0x621b("0x33")].showPanel(0),document[_0x621b("0x34")].appendChild(this.stats.domElement),this[_0x621b("0x35")]=_0x621b("0x36")in document,this.mousemove=_0x621b(this[_0x621b("0x35")]?"0x37":"0x38"),this[_0x621b("0x39")]=new dat.GUI;var t=this[_0x621b("0x39")][_0x621b("0x3a")](_0x621b("0x3b"));t[_0x621b("0x23")](this.params,"weight",.1,1),t[_0x621b("0x23")](this[_0x621b("0x3c")],"decay",.6,1),t[_0x621b("0x23")](this[_0x621b("0x3c")],_0x621b("0x3d"),.1,1),t[_0x621b("0x3e")](),t=this.gui[_0x621b("0x3a")](_0x621b("0x3f")),t[_0x621b("0x23")](this[_0x621b("0x3c")],_0x621b("0x40")),t[_0x621b("0x23")](this[_0x621b("0x3c")],_0x621b("0x1f"),.02,1),t.open(),this[_0x621b("0x39")][_0x621b("0x23")](this[_0x621b("0x3c")],_0x621b("0x41"),1,3.5)[_0x621b("0x42")](.25)[_0x621b("0x43")](this[_0x621b("0x44")]),this.then=Date[_0x621b("0x45")](),this.now=0,this[_0x621b("0x46")]=50,window[_0x621b("0x47")](_0x621b("0x48"),this.resize),this[_0x621b("0x49")](),this.resize()},save_screenshot:function(){this[_0x621b("0x4a")]();var x=this[_0x621b("0x26")][_0x621b("0x28")].gl.canvas,t=x[_0x621b("0x4b")](_0x621b("0x4c"));if(navigator[_0x621b("0x4d")].toLowerCase()[_0x621b("0x4e")](_0x621b("0x4f"))>-1){var n=new Date,e=n[_0x621b("0x50")]()+"-"+n.getMonth()+"-"+n[_0x621b("0x51")]()+"_"+n[_0x621b("0x52")]()+"."+n[_0x621b("0x53")]()+"."+n[_0x621b("0x54")](),i=document[_0x621b("0x55")]("a");i[_0x621b("0x56")]=t,i[_0x621b("0x57")]="pitchblack_"+e+".jpg",i[_0x621b("0x58")]()}else window[_0x621b("0x3e")](t)},set_quality:function(x){this[_0x621b("0x59")]=4-x,this[_0x621b("0x48")]()},draw:function(){this[_0x621b("0x13")]&&this[_0x621b("0x13")][_0x621b("0x5a")]===this[_0x621b("0x13")][_0x621b("0x5b")]&&this[_0x621b("0x30")]()},update:function(){this[_0x621b("0x24")][_0x621b("0x30")](),this[_0x621b("0x18")][_0x621b("0x5c")](),this.renderer[_0x621b("0x49")](this[_0x621b("0x22")],this.camera),this[_0x621b("0x1a")].bind(),this[_0x621b("0x1d")][_0x621b("0x29")][_0x621b("0x5d")](),this[_0x621b("0x1d")][_0x621b("0x29")][_0x621b("0x2c")](_0x621b("0x5e"),this.params.threshold),this.thresold.shader[_0x621b("0x2c")]("SOFT",this[_0x621b("0x3c")][_0x621b("0x5f")]),this[_0x621b("0x1d")][_0x621b("0x29")][_0x621b("0x2c")]("INVERT",this[_0x621b("0x3c")][_0x621b("0x40")]),this[_0x621b("0x1d")][_0x621b("0x29")][_0x621b("0x2c")](_0x621b("0x60"),this.rawFBO[_0x621b("0x24")]),this[_0x621b("0x26")].render(this[_0x621b("0x1d")]),this[_0x621b("0x26")].renderToScreen(),this.renderer[_0x621b("0x28")].gl.viewport(0,0,this[_0x621b("0x26")][_0x621b("0x28")][_0x621b("0x61")][_0x621b("0x62")],this[_0x621b("0x26")][_0x621b("0x28")][_0x621b("0x61")][_0x621b("0x63")]),this[_0x621b("0x64")][_0x621b("0x29")].use(),this[_0x621b("0x64")][_0x621b("0x29")][_0x621b("0x2c")](_0x621b("0x65"),this[_0x621b("0x3c")][_0x621b("0x66")]),this[_0x621b("0x64")][_0x621b("0x29")][_0x621b("0x2c")](_0x621b("0x67"),this[_0x621b("0x3c")][_0x621b("0x68")]),this[_0x621b("0x64")].shader[_0x621b("0x2c")](_0x621b("0x69"),this[_0x621b("0x3c")].density),this[_0x621b("0x64")][_0x621b("0x29")][_0x621b("0x2c")](_0x621b("0x60"),this.thresoldFBO[_0x621b("0x24")]),this[_0x621b("0x26")][_0x621b("0x49")](this[_0x621b("0x64")])},render:function(x){requestAnimationFrame(this[_0x621b("0x49")]),this[_0x621b("0x33")][_0x621b("0x6a")](),this[_0x621b("0x45")]=Date[_0x621b("0x45")]();var t=this[_0x621b("0x45")]-this[_0x621b("0x6b")];t>1e3/this[_0x621b("0x46")]&&(this[_0x621b("0x4a")](),this[_0x621b("0x6b")]=this[_0x621b("0x45")]-t%(1e3/this[_0x621b("0x46")])),this.stats[_0x621b("0x6c")]()},resize:function(x){if(this[_0x621b("0x13")]){var t=window[_0x621b("0x6d")],n=window[_0x621b("0x6e")],e=this[_0x621b("0x13")][_0x621b("0x6f")]/this.video.videoHeight;n=this.video[_0x621b("0x70")],t=n*e,this.rawFBO[_0x621b("0x48")](t/this[_0x621b("0x59")],n/this[_0x621b("0x59")]),this[_0x621b("0x71")][_0x621b("0x48")](t/this[_0x621b("0x59")],n/this[_0x621b("0x59")]),this.thresoldFBO[_0x621b("0x48")](t/this[_0x621b("0x59")],n/this[_0x621b("0x59")]),this[_0x621b("0x26")][_0x621b("0x28")][_0x621b("0x72")](t/this.scaling,n/this[_0x621b("0x59")],window[_0x621b("0x73")]),this[_0x621b("0x20")][_0x621b("0x74")]=(new(SQR[_0x621b("0x75")])).perspective(70,e,1,1e3)}}}})},function(x,t){x[_0x621b("0x0")]=_0x621b("0x76")},function(x,t){x.exports=_0x621b("0x77")}]);