!function(t){function e(i){if(s[i])return s[i].exports;var r=s[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var s={};e.m=t,e.c=s,e.d=function(t,s,i){e.o(t,s)||Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,s){t.exports=s(1)},function(t,e,s){"use strict";s(2),s(3),s(4),s(5)},function(t,e){},function(t,e){},function(t,e){},function(t,e,s){"use strict";new Vue({el:"#ui",data:{show:1,hud:0,isTouch:!1,noSupport:!1,scaling:1,params:{weight:.75,decay:.9,density:.85,quality:3,samples:20,threshold:.28,invert:!1,soft:.001}},mounted:function(){this.$nextTick(this.run)},methods:{run:function(){this.show=0,this.constraints={audio:!1,video:{mandatory:{minWidth:640,minHeight:480},optional:[{minFrameRate:35},{maxWidth:640},{maxHeigth:480}]}},void 0!==navigator.mediaDevices?navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia(this.constraints).then(this.done).catch(this.fail):this.noSupport=!0},done:function(t){this.stream=t,SQR.Loader.loadAssets([["glsl/thresold.glsl","thresold.glsl"],["glsl/godray.glsl","post.glsl"],"webcam"],this.sqr)},fail:function(){this.noSupport=!0},sqr:function(t){this.hud=1,this.show=0,this.video=t.webcam,this.renderer=SQR.Renderer("#gl",{antialias:!0}).clearColor(0,0,0,1),this.rawFBO=SQR.FrameBuffer(),this.postFBO=SQR.FrameBuffer(),this.thresoldFBO=SQR.FrameBuffer(),this.post=SQR.Primitives.createPostEffect(t["post.glsl"]),this.thresold=SQR.Primitives.createPostEffect(t["thresold.glsl"]),this.camera=SQR.Transform(),this.camera.position.z=2.5,this.root=SQR.Transform(),this.root.add(this.camera),this.texture=SQR.Texture(this.video,{isAnimated:!0,minFilter:this.renderer.context.gl.LINEAR,magFilter:this.renderer.context.gl.LINEAR}),this.shader=SQR.Shader(SQR.GLSL.texture).use().setUniform("uTexture",this.texture),this.plane=SQR.Transform(),this.plane.buffer=SQR.Primitives.createPlane(4,4,8,8,0,0).update(),this.plane.rotation.x=Math.PI/2,this.plane.shader=this.shader,this.root.add(this.plane),this.isTouch="ontouchstart"in document,this.mousemove=this.isTouch?"touchmove":"mousemove",window.addEventListener("resize",this.resize),this.tx=0,this.ty=0,this.mx=0,this.my=0,this.gui=new dat.GUI;var e=this.gui.addFolder("rays");e.add(this.params,"weight",.1,1),e.add(this.params,"decay",.6,1),e.add(this.params,"density",.1,1),e.open(),e=this.gui.addFolder("black & white"),e.add(this.params,"invert"),e.add(this.params,"threshold",.02,1),e.open(),this.gui.add(this.params,"quality",1,3.5).step(.25).onChange(this.set_quality),this.lastFrameTimeMs=Date.now(),this.resize(),this.render()},set_quality:function(t){this.scaling=4-t,this.resize()},draw:function(){this.video&&this.video.readyState===this.video.HAVE_ENOUGH_DATA&&(this.texture.update(),this.rawFBO.bind(),this.renderer.render(this.root,this.camera),this.thresoldFBO.bind(),this.thresold.shader.use(),this.thresold.shader.setUniform("THRESHOLD",this.params.threshold),this.thresold.shader.setUniform("SOFT",this.params.soft),this.thresold.shader.setUniform("INVERT",this.params.invert),this.thresold.shader.setUniform("uTexture",this.rawFBO.texture),this.renderer.render(this.thresold),this.renderer.renderToScreen(),this.renderer.context.gl.viewport(0,0,this.renderer.context.canvas.width,this.renderer.context.canvas.height),this.post.shader.use(),this.post.shader.setUniform("WEIGHT",this.params.weight),this.post.shader.setUniform("DECAY_FACTOR",this.params.decay),this.post.shader.setUniform("DENSITY",this.params.density),this.post.shader.setUniform("uTexture",this.thresoldFBO.texture),this.renderer.render(this.post))},render:function(t){if(t<this.lastFrameTimeMs+20)return void requestAnimationFrame(this.render);this.lastFrameTimeMs=t,this.draw(),requestAnimationFrame(this.render)},resize:function(t){var e=window.innerWidth,s=window.innerHeight,i=this.video.videoWidth;e=e>i?i:e,s=e/(16/9);var r=e/s;this.rawFBO.resize(e/this.scaling,s/this.scaling),this.postFBO.resize(e/this.scaling,s/this.scaling),this.thresoldFBO.resize(e/this.scaling,s/this.scaling),this.renderer.context.size(e/this.scaling,s/this.scaling,window.devicePixelRatio),this.camera.projection=(new SQR.ProjectionMatrix).perspective(70,r,1,1e3)}}})}]);
//# sourceMappingURL=bundle.app.js.map