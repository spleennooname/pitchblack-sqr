var _0x8d3e=["canvas","toDataURL","image/jpeg","userAgent","toLowerCase","indexOf","chrome","getMonth","getDate","getMinutes","getSeconds","createElement","href","pitchblack_",".jpg","click","open","readyState","HAVE_ENOUGH_DATA","bind","thresoldFBO","setUniform","THRESHOLD","SOFT","soft","renderToScreen","viewport","height","DECAY_FACTOR","DENSITY","innerHeight","videoWidth","videoHeight","scaling","size","devicePixelRatio","projection","ProjectionMatrix","perspective","#ifdef GL_ES\nprecision highp float;\n#endif\n\nattribute vec2 aPosition;\nattribute vec2 aUV;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vUV = aUV;\n}\n\n//#fragment\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D uTexture;\n\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n//thresold\n//https://www.shadertoy.com/view/4ssGR8\n\nuniform float SOFT;\nuniform float THRESHOLD;\nuniform bool INVERT;\n\n#define luma(r,g,b) ( 0.2126 * r + 0.7152 * g + 0.0722 * b )\n\nvoid main(){\n\n  vec2 uv = vUV;\n  vec4 tx = texture2D(uTexture, uv);\n\n  float lum = luma(tx.r, tx.g, tx.b);\n\n  vec3 c = vec3(1.0);\n\n  if ( INVERT == false)\n      c -= smoothstep( THRESHOLD+SOFT, THRESHOLD-SOFT, lum);\n  else\n      c -= smoothstep( THRESHOLD+SOFT, THRESHOLD+SOFT, lum);\n\n  gl_FragColor = vec4(c, 1.0);\n\n}\n","#ifdef GL_ES\nprecision mediump float;\n#endif\n\nattribute vec2 aPosition;\nattribute vec2 aUV;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vUV = aUV;\n}\n\n//#fragment\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform sampler2D uTexture;\nuniform float uTime;\n\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n//godray\n//https://www.shadertoy.com/view/4ssGR8\n\n//#define DECAY_FACTOR 0.75\n#define EXPOSURE 0.21\n//#define DENSITY 0.85\n//#define WEIGHT 0.58\n\n#define NUM_SAMPLES 25\n\nuniform float WEIGHT;\nuniform float DECAY_FACTOR;\nuniform float DENSITY;\n\n\nfloat rand(float n){return fract(sin(n) * 43758.5453123);}\n\nfloat rand(vec2 n) {\n\treturn fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\n\nfloat noise(float p){\n\tfloat fl = floor(p);\n  float fc = fract(p);\n\treturn mix(rand(fl), rand(fl + 1.0), fc);\n}\n\nfloat noise(vec2 n) {\n\tconst vec2 d = vec2(0.0, 1.0);\n  vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n}\n\n// float noise_v2(vec2 n) {\n// \tconst vec2 d = vec2(0.0, 1.0);\n//   vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n// \treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n// }\n\nvoid main(){\n\n  vec2 uv = vUV;\n  vec2 tc = uv;\n  vec2 delta_tc = uv;\n\n  float t = uTime;\n\n  t *= 0.0018;\n\n  delta_tc = uv + vec2( sin( t*.3)*.3, -cos(t*.2)*.3 ) - .5;\n  delta_tc *= 1.0 / float(NUM_SAMPLES) * DENSITY;\n\n  float illumination_decay = 0.95;\n  vec4 color = texture2D(uTexture, tc) ;\n  vec4 sample_tx;\n\n  tc += delta_tc * fract( sin( dot( uv.xy + fract( tc ), vec2(42.9898, 50.233) ) ) * 43758.5453 );\n\n  for(int i=0; i < NUM_SAMPLES; i++) {\n    tc -= delta_tc;\n    sample_tx = texture2D(uTexture, tc ) * illumination_decay * WEIGHT;\n    //sample_tx *= illumination_decay * WEIGHT;\n    color += sample_tx * tc.y;//noise( vec2(tc.y, tc.x) ) ;\n    illumination_decay *= DECAY_FACTOR ;\n  }\n\n  vec4 c = color;\n\n  gl_FragColor = c * EXPOSURE;\n\n}\n","call","exports","defineProperty","__esModule","default","run","getUserMedia","mediaDevices","show","constraints","hasCam","then","done","catch","fail","noSupport","Loader","webcam","onload","video","loop","muted","clearColor","rawFBO","postFBO","FrameBuffer","post","Primitives","createPostEffect","godrays","thresold","threshold","camera","position","root","Transform","add","texture","Texture","renderer","context","LINEAR","shader","Shader","GLSL","use","uTexture","plane","createPlane","update","rotation","scene","hud","stats","body","appendChild","domElement","isTouch","ontouchstart","mousemove","gui","GUI","addFolder","rays","params","weight","decay","density","black & white","invert","quality","step","set_quality","now","fps","resize","render"];!function(e,x){!function(x){for(;--x;)e.push(e.shift())}(++x)}(_0x8d3e,159);var _0xe8d3=function(e,x){return e-=0,_0x8d3e[e]};!function(e){function x(n){if(t[n])return t[n].exports;var d=t[n]={i:n,l:![],exports:{}};return e[n][_0xe8d3("0x0")](d[_0xe8d3("0x1")],d,d[_0xe8d3("0x1")],x),d.l=!![],d.exports}var t={};x.m=e,x.c=t,x.d=function(e,t,n){x.o(e,t)||Object[_0xe8d3("0x2")](e,t,{configurable:![],enumerable:!![],get:n})},x.n=function(e){var t=e&&e[_0xe8d3("0x3")]?function(){return e[_0xe8d3("0x4")]}:function(){return e};return x.d(t,"a",t),t},x.o=function(e,x){return Object.prototype.hasOwnProperty.call(e,x)},x.p="",x(x.s=0)}([function(e,x,t){e.exports=t(1)},function(e,x,t){"use strict";t(2),t(3),t(4),t(5)},function(e,x){},function(e,x){},function(e,x){},function(e,x,t){"use strict";var n={threshold:t(6),godrays:t(7)};new Vue({el:"#ui",data:{show:1,hud:0,isTouch:![],noSupport:![],scaling:1,params:{weight:.75,decay:.9,density:.85,quality:2.75,samples:20,threshold:.45,invert:![],soft:.001}},mounted:function(){this.$nextTick(this[_0xe8d3("0x5")])},methods:{hasCam:function(){return!!navigator[_0xe8d3("0x6")]||!(!navigator[_0xe8d3("0x7")]||!navigator[_0xe8d3("0x7")][_0xe8d3("0x6")])},run:function(){this[_0xe8d3("0x8")]=0,this[_0xe8d3("0x9")]={video:{mandatory:{minAspectRatio:1.25,maxAspectRatio:1.6},optional:[{minWidth:640},{minHeight:480},{maxWidth:960},{maxHeight:720}]}},this[_0xe8d3("0xa")]()?navigator[_0xe8d3("0x7")][_0xe8d3("0x6")](this[_0xe8d3("0x9")])[_0xe8d3("0xb")](this[_0xe8d3("0xc")])[_0xe8d3("0xd")](this[_0xe8d3("0xe")]):this[_0xe8d3("0xf")]=!![]},fail:function(){this.noSupport=!![]},done:function(e){SQR[_0xe8d3("0x10")].loadAssets([_0xe8d3("0x11")],this[_0xe8d3("0x12")])},onload:function(e){this[_0xe8d3("0x13")]=e[_0xe8d3("0x11")],this[_0xe8d3("0x13")][_0xe8d3("0x14")]=!![],this.video[_0xe8d3("0x15")]=!![],this.renderer=SQR.Renderer("#gl",{antialias:!![]})[_0xe8d3("0x16")](0,0,0,1),this[_0xe8d3("0x17")]=SQR.FrameBuffer(),this[_0xe8d3("0x18")]=SQR[_0xe8d3("0x19")](),this.thresoldFBO=SQR.FrameBuffer(),this[_0xe8d3("0x1a")]=SQR[_0xe8d3("0x1b")][_0xe8d3("0x1c")](n[_0xe8d3("0x1d")]),this[_0xe8d3("0x1e")]=SQR.Primitives[_0xe8d3("0x1c")](n[_0xe8d3("0x1f")]),this.camera=SQR.Transform(),this[_0xe8d3("0x20")][_0xe8d3("0x21")].z=2.5,this[_0xe8d3("0x22")]=SQR[_0xe8d3("0x23")](),this[_0xe8d3("0x22")][_0xe8d3("0x24")](this[_0xe8d3("0x20")]),this[_0xe8d3("0x25")]=SQR[_0xe8d3("0x26")](this.video,{isAnimated:!![],minFilter:this[_0xe8d3("0x27")][_0xe8d3("0x28")].gl.LINEAR,magFilter:this.renderer[_0xe8d3("0x28")].gl[_0xe8d3("0x29")]}),this[_0xe8d3("0x2a")]=SQR[_0xe8d3("0x2b")](SQR[_0xe8d3("0x2c")][_0xe8d3("0x25")])[_0xe8d3("0x2d")]().setUniform(_0xe8d3("0x2e"),this.texture),this[_0xe8d3("0x2f")]=SQR[_0xe8d3("0x23")](),this[_0xe8d3("0x2f")].buffer=SQR[_0xe8d3("0x1b")][_0xe8d3("0x30")](4,3,2,2,0,0)[_0xe8d3("0x31")](),this[_0xe8d3("0x2f")][_0xe8d3("0x32")].x=Math.PI/2,this[_0xe8d3("0x2f")][_0xe8d3("0x2a")]=this[_0xe8d3("0x2a")],this[_0xe8d3("0x22")][_0xe8d3("0x24")](this.plane),this[_0xe8d3("0x33")]()},scene:function(e){this[_0xe8d3("0x34")]=1,this[_0xe8d3("0x8")]=0,this[_0xe8d3("0x35")]=new Stats,this.stats.showPanel(0),document[_0xe8d3("0x36")][_0xe8d3("0x37")](this[_0xe8d3("0x35")][_0xe8d3("0x38")]),this[_0xe8d3("0x39")]=_0xe8d3("0x3a")in document,this[_0xe8d3("0x3b")]=this[_0xe8d3("0x39")]?"touchmove":_0xe8d3("0x3b"),this[_0xe8d3("0x3c")]=new(dat[_0xe8d3("0x3d")]);var x=this[_0xe8d3("0x3c")][_0xe8d3("0x3e")](_0xe8d3("0x3f"));x[_0xe8d3("0x24")](this[_0xe8d3("0x40")],_0xe8d3("0x41"),.1,1),x[_0xe8d3("0x24")](this.params,_0xe8d3("0x42"),.6,1),x[_0xe8d3("0x24")](this.params,_0xe8d3("0x43"),.1,1),x.open(),x=this[_0xe8d3("0x3c")].addFolder(_0xe8d3("0x44")),x[_0xe8d3("0x24")](this[_0xe8d3("0x40")],_0xe8d3("0x45")),x[_0xe8d3("0x24")](this[_0xe8d3("0x40")],_0xe8d3("0x1f"),.02,1),x.open(),this[_0xe8d3("0x3c")].add(this[_0xe8d3("0x40")],_0xe8d3("0x46"),1,3.5)[_0xe8d3("0x47")](.25).onChange(this[_0xe8d3("0x48")]),this[_0xe8d3("0xb")]=Date[_0xe8d3("0x49")](),this[_0xe8d3("0x49")]=0,this[_0xe8d3("0x4a")]=50,window.addEventListener(_0xe8d3("0x4b"),this.resize),this.render(),this[_0xe8d3("0x4b")]()},save_screenshot:function(){this[_0xe8d3("0x4c")]();var e=this[_0xe8d3("0x27")][_0xe8d3("0x28")].gl[_0xe8d3("0x4d")],x=e[_0xe8d3("0x4e")](_0xe8d3("0x4f"));if(navigator[_0xe8d3("0x50")][_0xe8d3("0x51")]()[_0xe8d3("0x52")](_0xe8d3("0x53"))>-1){var t=new Date,n=t.getFullYear()+"-"+t[_0xe8d3("0x54")]()+"-"+t[_0xe8d3("0x55")]()+"_"+t.getHours()+"."+t[_0xe8d3("0x56")]()+"."+t[_0xe8d3("0x57")](),d=document[_0xe8d3("0x58")]("a");d[_0xe8d3("0x59")]=x,d.download=_0xe8d3("0x5a")+n+_0xe8d3("0x5b"),d[_0xe8d3("0x5c")]()}else window[_0xe8d3("0x5d")](x)},set_quality:function(e){this.scaling=4-e,this[_0xe8d3("0x4b")]()},draw:function(){this.video&&this[_0xe8d3("0x13")][_0xe8d3("0x5e")]===this[_0xe8d3("0x13")][_0xe8d3("0x5f")]&&this[_0xe8d3("0x31")]()},update:function(){this[_0xe8d3("0x25")].update(),this.rawFBO[_0xe8d3("0x60")](),this[_0xe8d3("0x27")][_0xe8d3("0x4c")](this[_0xe8d3("0x22")],this.camera),this[_0xe8d3("0x61")][_0xe8d3("0x60")](),this[_0xe8d3("0x1e")][_0xe8d3("0x2a")].use(),this.thresold[_0xe8d3("0x2a")][_0xe8d3("0x62")](_0xe8d3("0x63"),this[_0xe8d3("0x40")][_0xe8d3("0x1f")]),this[_0xe8d3("0x1e")].shader[_0xe8d3("0x62")](_0xe8d3("0x64"),this.params[_0xe8d3("0x65")]),this.thresold.shader[_0xe8d3("0x62")]("INVERT",this.params.invert),this[_0xe8d3("0x1e")][_0xe8d3("0x2a")][_0xe8d3("0x62")](_0xe8d3("0x2e"),this[_0xe8d3("0x17")].texture),this.renderer[_0xe8d3("0x4c")](this.thresold),this[_0xe8d3("0x27")][_0xe8d3("0x66")](),this[_0xe8d3("0x27")][_0xe8d3("0x28")].gl[_0xe8d3("0x67")](0,0,this[_0xe8d3("0x27")].context[_0xe8d3("0x4d")].width,this[_0xe8d3("0x27")].context[_0xe8d3("0x4d")][_0xe8d3("0x68")]),this.post[_0xe8d3("0x2a")].use(),this.post[_0xe8d3("0x2a")][_0xe8d3("0x62")]("WEIGHT",this.params[_0xe8d3("0x41")]),this.post.shader[_0xe8d3("0x62")](_0xe8d3("0x69"),this[_0xe8d3("0x40")][_0xe8d3("0x42")]),this[_0xe8d3("0x1a")][_0xe8d3("0x2a")][_0xe8d3("0x62")](_0xe8d3("0x6a"),this[_0xe8d3("0x40")][_0xe8d3("0x43")]),this[_0xe8d3("0x1a")][_0xe8d3("0x2a")][_0xe8d3("0x62")](_0xe8d3("0x2e"),this[_0xe8d3("0x61")][_0xe8d3("0x25")]),this[_0xe8d3("0x27")][_0xe8d3("0x4c")](this[_0xe8d3("0x1a")])},render:function(e){requestAnimationFrame(this[_0xe8d3("0x4c")]),this[_0xe8d3("0x35")].begin(),this.now=Date[_0xe8d3("0x49")]();var x=this[_0xe8d3("0x49")]-this[_0xe8d3("0xb")];x>1e3/this[_0xe8d3("0x4a")]&&(this.draw(),this.then=this[_0xe8d3("0x49")]-x%(1e3/this[_0xe8d3("0x4a")])),this[_0xe8d3("0x35")].end()},resize:function(e){if(this[_0xe8d3("0x13")]){var x=window.innerWidth,t=window[_0xe8d3("0x6b")],n=this[_0xe8d3("0x13")][_0xe8d3("0x6c")]/this[_0xe8d3("0x13")][_0xe8d3("0x6d")];t=this[_0xe8d3("0x13")][_0xe8d3("0x6d")],x=t*n,this[_0xe8d3("0x17")][_0xe8d3("0x4b")](x/this.scaling,t/this[_0xe8d3("0x6e")]),this[_0xe8d3("0x18")].resize(x/this.scaling,t/this[_0xe8d3("0x6e")]),this[_0xe8d3("0x61")][_0xe8d3("0x4b")](x/this.scaling,t/this[_0xe8d3("0x6e")]),this[_0xe8d3("0x27")].context[_0xe8d3("0x6f")](x/this[_0xe8d3("0x6e")],t/this[_0xe8d3("0x6e")],window[_0xe8d3("0x70")]),this[_0xe8d3("0x20")][_0xe8d3("0x71")]=(new(SQR[_0xe8d3("0x72")]))[_0xe8d3("0x73")](70,n,1,1e3)}}}})},function(e,x){e.exports=_0xe8d3("0x74")},function(e,x){e[_0xe8d3("0x1")]=_0xe8d3("0x75")}]);