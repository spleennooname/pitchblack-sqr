var _0xf5d0=["stats","showPanel","body","appendChild","domElement","isTouch","ontouchstart","mousemove","touchmove","GUI","gui","addFolder","rays","params","weight","decay","open","black & white","quality","step","onChange","set_quality","now","fps","addEventListener","resize","render","draw","toDataURL","image/jpeg","userAgent","toLowerCase","indexOf","chrome","getMonth","getDate","getSeconds","href","download","pitchblack_",".jpg","scaling","readyState","HAVE_ENOUGH_DATA","bind","shader","SOFT","INVERT","viewport","canvas","width","height","WEIGHT","DECAY_FACTOR","DENSITY","thresoldFBO","begin","end","innerWidth","innerHeight","videoWidth","videoHeight","rawFBO","size","devicePixelRatio","projection","ProjectionMatrix","perspective","#ifdef GL_ES\nprecision highp float;\n#endif\n\nattribute vec2 aPosition;\nattribute vec2 aUV;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vUV = aUV;\n}\n\n//#fragment\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D uTexture;\n\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n//thresold\n//https://www.shadertoy.com/view/4ssGR8\n\nuniform float SOFT;\nuniform float THRESHOLD;\nuniform bool INVERT;\n\n#define luma(r,g,b) ( 0.2126 * r + 0.7152 * g + 0.0722 * b )\n\nvoid main(){\n\n  vec2 uv = vUV;\n  vec4 tx = texture2D(uTexture, uv);\n\n  float lum = luma(tx.r, tx.g, tx.b);\n\n  vec3 c = vec3(1.0);\n\n  if ( INVERT == false)\n      c -= smoothstep( THRESHOLD+SOFT, THRESHOLD-SOFT, lum);\n  else\n      c -= smoothstep( THRESHOLD+SOFT, THRESHOLD+SOFT, lum);\n\n  gl_FragColor = vec4(c, 1.0);\n\n}\n","#ifdef GL_ES\nprecision mediump float;\n#endif\n\nattribute vec2 aPosition;\nattribute vec2 aUV;\n\nvarying vec2 vUV;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vUV = aUV;\n}\n\n//#fragment\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nuniform sampler2D uTexture;\nuniform float uTime;\n\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n//godray\n//https://www.shadertoy.com/view/4ssGR8\n\n//#define DECAY_FACTOR 0.75\n#define EXPOSURE 0.21\n//#define DENSITY 0.85\n//#define WEIGHT 0.58\n\n#define NUM_SAMPLES 25\n\nuniform float WEIGHT;\nuniform float DECAY_FACTOR;\nuniform float DENSITY;\n\n\nfloat rand(float n){return fract(sin(n) * 43758.5453123);}\n\nfloat rand(vec2 n) {\n\treturn fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\n\nfloat noise(float p){\n\tfloat fl = floor(p);\n  float fc = fract(p);\n\treturn mix(rand(fl), rand(fl + 1.0), fc);\n}\n\nfloat noise(vec2 n) {\n\tconst vec2 d = vec2(0.0, 1.0);\n  vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n\treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n}\n\n// float noise_v2(vec2 n) {\n// \tconst vec2 d = vec2(0.0, 1.0);\n//   vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n// \treturn mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n// }\n\nvoid main(){\n\n  vec2 uv = vUV;\n  vec2 tc = uv;\n  vec2 delta_tc = uv;\n\n  float t = uTime;\n\n  t *= 0.0018;\n\n  delta_tc = uv + vec2( sin( t*.3)*.3, -cos(t*.2)*.3 ) - .5;\n  delta_tc *= 1.0 / float(NUM_SAMPLES) * DENSITY;\n\n  float illumination_decay = 0.95;\n  vec4 color = texture2D(uTexture, tc) ;\n  vec4 sample_tx;\n\n  tc += delta_tc * fract( sin( dot( uv.xy + fract( tc ), vec2(42.9898, 50.233) ) ) * 43758.5453 );\n\n  for(int i=0; i < NUM_SAMPLES; i++) {\n    tc -= delta_tc;\n    sample_tx = texture2D(uTexture, tc ) * illumination_decay * WEIGHT;\n    //sample_tx *= illumination_decay * WEIGHT;\n    color += sample_tx * tc.y;//noise( vec2(tc.y, tc.x) ) ;\n    illumination_decay *= DECAY_FACTOR ;\n  }\n\n  vec4 c = color;\n\n  gl_FragColor = c * EXPOSURE;\n\n}\n","call","exports","defineProperty","hasOwnProperty","run","mediaDevices","getUserMedia","show","constraints","hasCam","then","done","fail","video","createElement","loop","onload","renderer","Renderer","#gl","clearColor","FrameBuffer","postFBO","post","Primitives","createPostEffect","godrays","thresold","threshold","camera","Transform","root","add","texture","context","LINEAR","GLSL","use","setUniform","uTexture","plane","buffer","update","rotation","hud"];!function(x,t){!function(t){for(;--t;)x.push(x.shift())}(++t)}(_0xf5d0,185);var _0x0f5d=function(x,t){return x-=0,_0xf5d0[x]};!function(x){function t(d){if(n[d])return n[d].exports;var i=n[d]={i:d,l:![],exports:{}};return x[d][_0x0f5d("0x0")](i[_0x0f5d("0x1")],i,i[_0x0f5d("0x1")],t),i.l=!![],i.exports}var n={};t.m=x,t.c=n,t.d=function(x,n,d){t.o(x,n)||Object[_0x0f5d("0x2")](x,n,{configurable:![],enumerable:!![],get:d})},t.n=function(x){var n=x&&x.__esModule?function(){return x.default}:function(){return x};return t.d(n,"a",n),n},t.o=function(x,t){return Object.prototype[_0x0f5d("0x3")][_0x0f5d("0x0")](x,t)},t.p="",t(t.s=0)}([function(x,t,n){x[_0x0f5d("0x1")]=n(1)},function(x,t,n){"use strict";n(2),n(3),n(4),n(5)},function(x,t){},function(x,t){},function(x,t){},function(x,t,n){"use strict";var d={threshold:n(6),godrays:n(7)};new Vue({el:"#ui",data:{show:1,hud:0,isTouch:![],noSupport:![],scaling:1,params:{weight:.75,decay:.9,density:.85,quality:2.75,samples:20,threshold:.45,invert:![],soft:.001}},mounted:function(){this.$nextTick(this[_0x0f5d("0x4")])},methods:{hasCam:function(){return!!navigator.getUserMedia||!(!navigator.mediaDevices||!navigator[_0x0f5d("0x5")][_0x0f5d("0x6")])},run:function(){this[_0x0f5d("0x7")]=0,this[_0x0f5d("0x8")]={video:{mandatory:{minAspectRatio:1.25,maxAspectRatio:1.6},optional:[{minWidth:640},{minHeight:480},{maxWidth:960},{maxHeight:720}]}},this[_0x0f5d("0x9")]()?navigator[_0x0f5d("0x5")][_0x0f5d("0x6")](this[_0x0f5d("0x8")])[_0x0f5d("0xa")](this[_0x0f5d("0xb")]).catch(this[_0x0f5d("0xc")]):this.noSupport=!![]},fail:function(){this.noSupport=!![]},done:function(x){this[_0x0f5d("0xd")]=document[_0x0f5d("0xe")](_0x0f5d("0xd")),this.video.srcObject=x,this[_0x0f5d("0xd")][_0x0f5d("0xf")]=!![],this.video.muted=!![],this[_0x0f5d("0xd")].onloadedmetadata=this[_0x0f5d("0x10")]},onload:function(){this[_0x0f5d("0x11")]=SQR[_0x0f5d("0x12")](_0x0f5d("0x13"),{antialias:![]})[_0x0f5d("0x14")](0,0,0,1),this.rawFBO=SQR[_0x0f5d("0x15")](),this[_0x0f5d("0x16")]=SQR.FrameBuffer(),this.thresoldFBO=SQR[_0x0f5d("0x15")](),this[_0x0f5d("0x17")]=SQR[_0x0f5d("0x18")][_0x0f5d("0x19")](d[_0x0f5d("0x1a")]),this[_0x0f5d("0x1b")]=SQR[_0x0f5d("0x18")][_0x0f5d("0x19")](d[_0x0f5d("0x1c")]),this[_0x0f5d("0x1d")]=SQR[_0x0f5d("0x1e")](),this.camera.position.z=2.5,this[_0x0f5d("0x1f")]=SQR.Transform(),this[_0x0f5d("0x1f")][_0x0f5d("0x20")](this[_0x0f5d("0x1d")]),this[_0x0f5d("0x21")]=SQR.Texture(this[_0x0f5d("0xd")],{isAnimated:!![],minFilter:this[_0x0f5d("0x11")][_0x0f5d("0x22")].gl.LINEAR,magFilter:this[_0x0f5d("0x11")].context.gl[_0x0f5d("0x23")]}),this.shader=SQR.Shader(SQR[_0x0f5d("0x24")].texture)[_0x0f5d("0x25")]()[_0x0f5d("0x26")](_0x0f5d("0x27"),this[_0x0f5d("0x21")]),this.plane=SQR[_0x0f5d("0x1e")](),this[_0x0f5d("0x28")][_0x0f5d("0x29")]=SQR.Primitives.createPlane(4,3,2,2,0,0)[_0x0f5d("0x2a")](),this[_0x0f5d("0x28")][_0x0f5d("0x2b")].x=Math.PI/2,this.plane.shader=this.shader,this.root[_0x0f5d("0x20")](this.plane),this.scene()},scene:function(x){this[_0x0f5d("0x2c")]=1,this[_0x0f5d("0x7")]=0,this[_0x0f5d("0x2d")]=new Stats,this[_0x0f5d("0x2d")][_0x0f5d("0x2e")](0),document[_0x0f5d("0x2f")][_0x0f5d("0x30")](this.stats[_0x0f5d("0x31")]),this[_0x0f5d("0x32")]=_0x0f5d("0x33")in document,this[_0x0f5d("0x34")]=this[_0x0f5d("0x32")]?_0x0f5d("0x35"):"mousemove",this.gui=new(dat[_0x0f5d("0x36")]);var t=this[_0x0f5d("0x37")][_0x0f5d("0x38")](_0x0f5d("0x39"));t[_0x0f5d("0x20")](this[_0x0f5d("0x3a")],_0x0f5d("0x3b"),.1,1),t.add(this[_0x0f5d("0x3a")],_0x0f5d("0x3c"),.6,1),t[_0x0f5d("0x20")](this[_0x0f5d("0x3a")],"density",.1,1),t[_0x0f5d("0x3d")](),t=this.gui[_0x0f5d("0x38")](_0x0f5d("0x3e")),t[_0x0f5d("0x20")](this[_0x0f5d("0x3a")],"invert"),t[_0x0f5d("0x20")](this[_0x0f5d("0x3a")],_0x0f5d("0x1c"),.02,1),t[_0x0f5d("0x3d")](),this[_0x0f5d("0x37")][_0x0f5d("0x20")](this[_0x0f5d("0x3a")],_0x0f5d("0x3f"),1,3.5)[_0x0f5d("0x40")](.25)[_0x0f5d("0x41")](this[_0x0f5d("0x42")]),this[_0x0f5d("0xa")]=Date.now(),this[_0x0f5d("0x43")]=0,this[_0x0f5d("0x44")]=50,window[_0x0f5d("0x45")](_0x0f5d("0x46"),this[_0x0f5d("0x46")]),this[_0x0f5d("0x47")](),this[_0x0f5d("0x46")]()},save_screenshot:function(){this[_0x0f5d("0x48")]();var x=this[_0x0f5d("0x11")][_0x0f5d("0x22")].gl.canvas,t=x[_0x0f5d("0x49")](_0x0f5d("0x4a"));if(navigator[_0x0f5d("0x4b")][_0x0f5d("0x4c")]()[_0x0f5d("0x4d")](_0x0f5d("0x4e"))>-1){var n=new Date,d=n.getFullYear()+"-"+n[_0x0f5d("0x4f")]()+"-"+n[_0x0f5d("0x50")]()+"_"+n.getHours()+"."+n.getMinutes()+"."+n[_0x0f5d("0x51")](),i=document[_0x0f5d("0xe")]("a");i[_0x0f5d("0x52")]=t,i[_0x0f5d("0x53")]=_0x0f5d("0x54")+d+_0x0f5d("0x55"),i.click()}else window[_0x0f5d("0x3d")](t)},set_quality:function(x){this[_0x0f5d("0x56")]=4-x,this[_0x0f5d("0x46")]()},draw:function(){this[_0x0f5d("0xd")]&&this[_0x0f5d("0xd")][_0x0f5d("0x57")]===this[_0x0f5d("0xd")][_0x0f5d("0x58")]&&this[_0x0f5d("0x2a")]()},update:function(){this[_0x0f5d("0x21")][_0x0f5d("0x2a")](),this.rawFBO[_0x0f5d("0x59")](),this.renderer[_0x0f5d("0x47")](this.root,this[_0x0f5d("0x1d")]),this.thresoldFBO[_0x0f5d("0x59")](),this[_0x0f5d("0x1b")][_0x0f5d("0x5a")][_0x0f5d("0x25")](),this[_0x0f5d("0x1b")].shader[_0x0f5d("0x26")]("THRESHOLD",this.params[_0x0f5d("0x1c")]),this.thresold[_0x0f5d("0x5a")].setUniform(_0x0f5d("0x5b"),this.params.soft),this[_0x0f5d("0x1b")][_0x0f5d("0x5a")][_0x0f5d("0x26")](_0x0f5d("0x5c"),this[_0x0f5d("0x3a")].invert),this[_0x0f5d("0x1b")].shader[_0x0f5d("0x26")](_0x0f5d("0x27"),this.rawFBO[_0x0f5d("0x21")]),this[_0x0f5d("0x11")][_0x0f5d("0x47")](this.thresold),this[_0x0f5d("0x11")].renderToScreen(),this[_0x0f5d("0x11")].context.gl[_0x0f5d("0x5d")](0,0,this[_0x0f5d("0x11")][_0x0f5d("0x22")][_0x0f5d("0x5e")][_0x0f5d("0x5f")],this[_0x0f5d("0x11")][_0x0f5d("0x22")].canvas[_0x0f5d("0x60")]),this[_0x0f5d("0x17")][_0x0f5d("0x5a")][_0x0f5d("0x25")](),this[_0x0f5d("0x17")][_0x0f5d("0x5a")].setUniform(_0x0f5d("0x61"),this[_0x0f5d("0x3a")].weight),this[_0x0f5d("0x17")][_0x0f5d("0x5a")][_0x0f5d("0x26")](_0x0f5d("0x62"),this[_0x0f5d("0x3a")].decay),this[_0x0f5d("0x17")][_0x0f5d("0x5a")][_0x0f5d("0x26")](_0x0f5d("0x63"),this[_0x0f5d("0x3a")].density),this[_0x0f5d("0x17")][_0x0f5d("0x5a")][_0x0f5d("0x26")](_0x0f5d("0x27"),this[_0x0f5d("0x64")][_0x0f5d("0x21")]),this[_0x0f5d("0x11")].render(this[_0x0f5d("0x17")])},render:function(x){requestAnimationFrame(this[_0x0f5d("0x47")]),this[_0x0f5d("0x2d")][_0x0f5d("0x65")](),this[_0x0f5d("0x43")]=Date[_0x0f5d("0x43")]();var t=this[_0x0f5d("0x43")]-this.then;t>1e3/this.fps&&(this.draw(),this[_0x0f5d("0xa")]=this[_0x0f5d("0x43")]-t%(1e3/this.fps)),this[_0x0f5d("0x2d")][_0x0f5d("0x66")]()},resize:function(x){if(this[_0x0f5d("0xd")]){var t=window[_0x0f5d("0x67")],n=window[_0x0f5d("0x68")],d=this[_0x0f5d("0xd")][_0x0f5d("0x69")]/this.video.videoHeight;n=this.video[_0x0f5d("0x6a")],t=n*d,this[_0x0f5d("0x6b")].resize(t/this[_0x0f5d("0x56")],n/this.scaling),this[_0x0f5d("0x16")][_0x0f5d("0x46")](t/this.scaling,n/this.scaling),this[_0x0f5d("0x64")][_0x0f5d("0x46")](t/this.scaling,n/this[_0x0f5d("0x56")]),this[_0x0f5d("0x11")].context[_0x0f5d("0x6c")](t/this[_0x0f5d("0x56")],n/this.scaling,window[_0x0f5d("0x6d")]),this[_0x0f5d("0x1d")][_0x0f5d("0x6e")]=(new(SQR[_0x0f5d("0x6f")]))[_0x0f5d("0x70")](70,d,1,1e3)}}}})},function(x,t){x[_0x0f5d("0x1")]=_0x0f5d("0x71")},function(x,t){x[_0x0f5d("0x1")]=_0x0f5d("0x72")}]);