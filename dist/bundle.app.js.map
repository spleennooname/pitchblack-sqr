{"version":3,"sources":["webpack:///bundle.app.js","webpack:///webpack/bootstrap e5f2b27e7e52f7ba27fe","webpack:///./src/app.js","webpack:///./src/app/app.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","Vue","el","data","show","hud","isTouch","noSupport","scaling","params","weight","decay","density","quality","samples","threshold","invert","soft","mounted","this","$nextTick","run","methods","constraints","audio","video","mandatory","minWidth","minHeight","optional","minFrameRate","maxWidth","maxHeigth","navigator","mediaDevices","getUserMedia","then","done","catch","fail","stream","SQR","Loader","loadAssets","sqr","assets","webcam","renderer","Renderer","antialias","clearColor","rawFBO","FrameBuffer","postFBO","thresoldFBO","post","Primitives","createPostEffect","thresold","camera","Transform","position","z","root","add","texture","Texture","isAnimated","minFilter","context","gl","LINEAR","magFilter","shader","Shader","GLSL","use","setUniform","plane","buffer","createPlane","update","rotation","x","Math","PI","document","mousemove","window","addEventListener","resize","tx","ty","mx","my","gui","dat","GUI","f","addFolder","open","step","onChange","set_quality","lastFrameTimeMs","Date","now","render","value","draw","readyState","HAVE_ENOUGH_DATA","bind","renderToScreen","viewport","canvas","width","height","timestamp","requestAnimationFrame","e","w","innerWidth","h","innerHeight","wCam","videoWidth","aspect","size","devicePixelRatio","projection","ProjectionMatrix","perspective"],"mappings":"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","file":"bundle.app.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(1);\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(2);\n__webpack_require__(3);\n__webpack_require__(4);\n__webpack_require__(5);\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n// start app\n\nvar app = new Vue({\n\n  el: '#ui',\n\n  data: {\n    show: 1,\n    hud: 0,\n    isTouch: false,\n    noSupport: false,\n    scaling: 1,\n    params: {\n      weight: 0.75,\n      decay: 0.90,\n      density: 0.85,\n      quality: 3,\n      samples: 20,\n      threshold: 0.28,\n      invert: false,\n      soft: 0.001\n    }\n  },\n\n  mounted: function mounted() {\n    this.$nextTick(this.run);\n  },\n\n\n  methods: {\n    run: function run() {\n\n      this.show = 0;\n      this.constraints = {\n        audio: false,\n        video: {\n          mandatory: { minWidth: 640, minHeight: 480 },\n          optional: [{ minFrameRate: 35 }, { maxWidth: 640 }, { maxHeigth: 480 }]\n        }\n      };\n\n      if (typeof navigator.mediaDevices !== \"undefined\") {\n        if (!!navigator.mediaDevices.getUserMedia) {\n          navigator.mediaDevices.getUserMedia(this.constraints).then(this.done).catch(this.fail);\n        }\n      } else {\n        this.noSupport = true;\n      }\n    },\n    done: function done(stream) {\n\n      this.stream = stream;\n\n      SQR.Loader.loadAssets([['glsl/thresold.glsl', 'thresold.glsl'], ['glsl/godray.glsl', 'post.glsl'], 'webcam'], this.sqr);\n    },\n    fail: function fail() {\n      this.noSupport = true;\n    },\n    sqr: function sqr(assets) {\n\n      this.hud = 1;\n      this.show = 0;\n\n      this.video = assets.webcam;\n      //assets.webcam.srcObject = this.stream;\n\n      // console.log(\"sqr\", assets.webcam)\n\n      //console.log(this.video, this.video instanceof HTMLVideoElement, this);\n\n      // this.stats = new Stats();\n      // this.stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\n      // document.body.appendChild(this.stats.domElement);\n\n      this.renderer = SQR.Renderer('#gl', {\n        antialias: true\n      }).clearColor(0.0, 0.0, 0.0, 1);\n\n      //console.log( this.renderer)\n\n      this.rawFBO = SQR.FrameBuffer();\n      this.postFBO = SQR.FrameBuffer();\n      this.thresoldFBO = SQR.FrameBuffer();\n\n      this.post = SQR.Primitives.createPostEffect(assets['post.glsl']);\n      this.thresold = SQR.Primitives.createPostEffect(assets['thresold.glsl']);\n\n      this.camera = SQR.Transform();\n      this.camera.position.z = 2.5;\n\n      //root\n      this.root = SQR.Transform();\n      this.root.add(this.camera);\n\n      this.texture = SQR.Texture(this.video, {\n        isAnimated: true,\n        minFilter: this.renderer.context.gl.LINEAR,\n        magFilter: this.renderer.context.gl.LINEAR\n      });\n\n      this.shader = SQR.Shader(SQR.GLSL.texture).use().setUniform('uTexture', this.texture);\n\n      this.plane = SQR.Transform();\n      this.plane.buffer = SQR.Primitives.createPlane(4, 4, 8, 8, 0, 0).update();\n      this.plane.rotation.x = Math.PI / 2;\n      this.plane.shader = this.shader;\n\n      this.root.add(this.plane);\n\n      //events\n\n      this.isTouch = 'ontouchstart' in document;\n      this.mousemove = this.isTouch ? 'touchmove' : 'mousemove';\n      window.addEventListener('resize', this.resize);\n\n      this.tx = 0;\n      this.ty = 0;\n      this.mx = 0;\n      this.my = 0;\n\n      this.gui = new dat.GUI();\n\n      var f = this.gui.addFolder('rays');\n\n      f.add(this.params, 'weight', 0.1, 1.0);\n      f.add(this.params, 'decay', 0.6, 1.0);\n      f.add(this.params, 'density', 0.1, 1.0);\n      f.open();\n\n      //f.add(this.params, 'samples', 10.0, 25.0).step(1.0)\n      //f.add(this.params, 'quality', 1, 4).step(1.0).onFinishChange( this.set_quality );\n\n      f = this.gui.addFolder('black & white');\n      f.add(this.params, 'invert');\n      f.add(this.params, 'threshold', 0.02, 1.0);\n      f.open();\n\n      this.gui.add(this.params, 'quality', 1.0, 3.5).step(0.25).onChange(this.set_quality);\n\n      // this.gui.add(this.params, 'quality', {\n      //   High: 1,\n      //   Mid: 2,\n      //   Low: 3\n      // }).onChange(this.set_quality);\n\n      //console.log( this.texture.getSource().videoWidth, this.texture.getSource().videoHeight );\n\n      this.lastFrameTimeMs = Date.now();\n      this.resize();\n      this.render();\n    },\n\n\n    // set_weight: function (value) {\n    //   // this.post.shader.setUniform('WEIGHT', value);\n    // },\n    //\n    // set_decay: function (value) {\n    //   // this.post.shader.setUniform('DECAY_FACTOR', value);\n    // },\n    //\n    // set_density: function (value) {\n    //   // this.post.shader.setUniform('DENSITY', value);\n    // },\n\n    set_quality: function set_quality(value) {\n      // this.post.shader.setUniform('DENSITY', value);\n      this.scaling = 4 - value;\n      this.resize();\n    },\n    draw: function draw() {\n\n      if (!this.video) {\n        return;\n      }\n      if (this.video.readyState !== this.video.HAVE_ENOUGH_DATA) {\n        return;\n      }\n\n      this.texture.update();\n\n      this.rawFBO.bind();\n      this.renderer.render(this.root, this.camera);\n\n      this.thresoldFBO.bind();\n      this.thresold.shader.use();\n      this.thresold.shader.setUniform('THRESHOLD', this.params[\"threshold\"]);\n      this.thresold.shader.setUniform('SOFT', this.params[\"soft\"]);\n      this.thresold.shader.setUniform('INVERT', this.params[\"invert\"]);\n      this.thresold.shader.setUniform('uTexture', this.rawFBO.texture);\n      this.renderer.render(this.thresold);\n\n      this.renderer.renderToScreen();\n      this.renderer.context.gl.viewport(0, 0, this.renderer.context.canvas.width, this.renderer.context.canvas.height);\n\n      this.post.shader.use();\n      this.post.shader.setUniform('WEIGHT', this.params[\"weight\"]);\n      this.post.shader.setUniform('DECAY_FACTOR', this.params[\"decay\"]);\n      //this.post.shader.setUniform('NUM_SAMPLES', this.params[\"samples\"]);\n      this.post.shader.setUniform('DENSITY', this.params[\"density\"]);\n      this.post.shader.setUniform('uTexture', this.thresoldFBO.texture);\n      this.renderer.render(this.post);\n    },\n    render: function render(timestamp) {\n\n      // Throttle the frame rate.\n      if (timestamp < this.lastFrameTimeMs + 1000 / 50) {\n        requestAnimationFrame(this.render);\n        return;\n      }\n      this.lastFrameTimeMs = timestamp;\n\n      this.draw();\n\n      requestAnimationFrame(this.render);\n    },\n    resize: function resize(e) {\n\n      var w = window.innerWidth,\n          h = window.innerHeight,\n          wCam = this.video.videoWidth;\n\n      w = w > wCam ? wCam : w;\n      h = w / (16 / 9); // 9/16 * 100\n\n      var aspect = w / h;\n      // console.log(this.scaling, \":\",w / this.scaling, h / this.scaling);\n\n      this.rawFBO.resize(w / this.scaling, h / this.scaling);\n      this.postFBO.resize(w / this.scaling, h / this.scaling);\n      this.thresoldFBO.resize(w / this.scaling, h / this.scaling);\n\n      this.renderer.context.size(w / this.scaling, h / this.scaling, window.devicePixelRatio);\n      this.camera.projection = new SQR.ProjectionMatrix().perspective(70, aspect, 1, 1000);\n    }\n  }\n});\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.app.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e5f2b27e7e52f7ba27fe","require(\"./css/dg.scss\");\nrequire(\"./css/transitions.scss\");\nrequire(\"./css/style.scss\");\nrequire(\"./app/app.js\");\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","// start app\n\nconst app = new Vue({\n\n  el: '#ui',\n\n  data: {\n    show: 1,\n    hud: 0,\n    isTouch: false,\n    noSupport: false,\n    scaling: 1,\n    params: {\n      weight: 0.75,\n      decay: 0.90,\n      density: 0.85,\n      quality: 3,\n      samples: 20,\n      threshold: 0.28,\n      invert: false,\n      soft: 0.001\n    }\n  },\n\n  mounted() {\n    this.$nextTick(this.run);\n  },\n\n  methods: {\n\n    run() {\n\n      this.show = 0;\n      this.constraints = {\n        audio: false,\n        video: {\n          mandatory: { minWidth: 640, minHeight: 480 },\n          optional: [\n            { minFrameRate: 35 },\n            { maxWidth: 640 },\n            { maxHeigth: 480 }\n          ]\n        }\n      }\n\n      if (typeof navigator.mediaDevices !== \"undefined\"){\n        if (!!navigator.mediaDevices.getUserMedia) {\n          navigator.mediaDevices.getUserMedia(this.constraints)\n            .then(this.done)\n            .catch(this.fail);\n        }\n      }\n      else {\n        this.noSupport = true;\n      }\n\n    },\n\n    done(stream) {\n\n      this.stream = stream;\n\n      SQR.Loader.loadAssets([\n        ['glsl/thresold.glsl', 'thresold.glsl'],\n        ['glsl/godray.glsl', 'post.glsl'],\n        'webcam'\n        ], this.sqr);\n    },\n\n    fail() {\n      this.noSupport = true;\n    },\n\n    sqr(assets) {\n\n      this.hud = 1;\n      this.show = 0;\n\n      this.video = assets.webcam;\n      //assets.webcam.srcObject = this.stream;\n\n      // console.log(\"sqr\", assets.webcam)\n\n      //console.log(this.video, this.video instanceof HTMLVideoElement, this);\n\n      // this.stats = new Stats();\n      // this.stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\n      // document.body.appendChild(this.stats.domElement);\n\n      this.renderer = SQR.Renderer('#gl', {\n          antialias: true\n        })\n        .clearColor(0.0, 0.0, 0.0, 1);\n\n      //console.log( this.renderer)\n\n      this.rawFBO = SQR.FrameBuffer();\n      this.postFBO = SQR.FrameBuffer();\n      this.thresoldFBO = SQR.FrameBuffer();\n\n      this.post = SQR.Primitives.createPostEffect(assets['post.glsl']);\n      this.thresold = SQR.Primitives.createPostEffect(assets['thresold.glsl']);\n\n      this.camera = SQR.Transform();\n      this.camera.position.z = 2.5;\n\n      //root\n      this.root = SQR.Transform();\n      this.root.add(this.camera);\n\n      this.texture = SQR.Texture(this.video, {\n        isAnimated: true,\n        minFilter: this.renderer.context.gl.LINEAR,\n        magFilter: this.renderer.context.gl.LINEAR\n      });\n\n      this.shader = SQR.Shader(SQR.GLSL.texture).use().setUniform('uTexture', this.texture);\n\n      this.plane = SQR.Transform();\n      this.plane.buffer = SQR.Primitives.createPlane(4, 4, 8, 8, 0, 0).update();\n      this.plane.rotation.x = Math.PI / 2;\n      this.plane.shader = this.shader;\n\n      this.root.add(this.plane);\n\n      //events\n\n      this.isTouch = 'ontouchstart' in document;\n      this.mousemove = this.isTouch ? 'touchmove' : 'mousemove';\n      window.addEventListener('resize', this.resize);\n\n      this.tx = 0;\n      this.ty = 0;\n      this.mx = 0;\n      this.my = 0;\n\n      this.gui = new dat.GUI();\n\n      var f = this.gui.addFolder('rays');\n\n      f.add(this.params, 'weight', 0.1, 1.0);\n      f.add(this.params, 'decay', 0.6, 1.0);\n      f.add(this.params, 'density', 0.1, 1.0);\n      f.open();\n\n      //f.add(this.params, 'samples', 10.0, 25.0).step(1.0)\n      //f.add(this.params, 'quality', 1, 4).step(1.0).onFinishChange( this.set_quality );\n\n      f = this.gui.addFolder('black & white');\n      f.add(this.params, 'invert');\n      f.add(this.params, 'threshold', 0.02, 1.0);\n      f.open();\n\n      this.gui.add(this.params, 'quality', 1.0, 3.5).step(0.25).onChange(this.set_quality);\n\n      // this.gui.add(this.params, 'quality', {\n      //   High: 1,\n      //   Mid: 2,\n      //   Low: 3\n      // }).onChange(this.set_quality);\n\n      //console.log( this.texture.getSource().videoWidth, this.texture.getSource().videoHeight );\n\n      this.lastFrameTimeMs = Date.now();\n      this.resize();\n      this.render();\n\n    },\n\n    // set_weight: function (value) {\n    //   // this.post.shader.setUniform('WEIGHT', value);\n    // },\n    //\n    // set_decay: function (value) {\n    //   // this.post.shader.setUniform('DECAY_FACTOR', value);\n    // },\n    //\n    // set_density: function (value) {\n    //   // this.post.shader.setUniform('DENSITY', value);\n    // },\n\n    set_quality(value) {\n      // this.post.shader.setUniform('DENSITY', value);\n      this.scaling = 4 - value;\n      this.resize();\n    },\n\n    draw() {\n\n      if( !this.video){\n        return;\n      }\n      if (this.video.readyState !== this.video.HAVE_ENOUGH_DATA) {\n        return;\n      }\n\n      this.texture.update();\n\n      this.rawFBO.bind();\n      this.renderer.render(this.root, this.camera);\n\n      this.thresoldFBO.bind();\n      this.thresold.shader.use();\n      this.thresold.shader.setUniform('THRESHOLD', this.params[\"threshold\"]);\n      this.thresold.shader.setUniform('SOFT', this.params[\"soft\"]);\n      this.thresold.shader.setUniform('INVERT', this.params[\"invert\"]);\n      this.thresold.shader.setUniform('uTexture', this.rawFBO.texture);\n      this.renderer.render(this.thresold);\n\n      this.renderer.renderToScreen();\n      this.renderer.context.gl.viewport(0, 0, this.renderer.context.canvas.width, this.renderer.context.canvas.height);\n\n      this.post.shader.use();\n      this.post.shader.setUniform('WEIGHT', this.params[\"weight\"]);\n      this.post.shader.setUniform('DECAY_FACTOR', this.params[\"decay\"]);\n      //this.post.shader.setUniform('NUM_SAMPLES', this.params[\"samples\"]);\n      this.post.shader.setUniform('DENSITY', this.params[\"density\"]);\n      this.post.shader.setUniform('uTexture', this.thresoldFBO.texture);\n      this.renderer.render(this.post);\n\n    },\n\n    render(timestamp) {\n\n      // Throttle the frame rate.\n       if (timestamp < this.lastFrameTimeMs + (1000 / 50 )) {\n           requestAnimationFrame(this.render);\n           return;\n       }\n       this.lastFrameTimeMs = timestamp;\n\n      this.draw();\n\n      requestAnimationFrame(this.render);\n\n    },\n\n    resize(e) {\n\n      var w = window.innerWidth,\n          h = window.innerHeight,\n          wCam = this.video.videoWidth;\n\n      w = w > wCam ? wCam : w;\n      h = w / (16 / 9); // 9/16 * 100\n\n      var aspect = w / h;\n      // console.log(this.scaling, \":\",w / this.scaling, h / this.scaling);\n\n      this.rawFBO.resize(w / this.scaling, h / this.scaling);\n      this.postFBO.resize(w / this.scaling, h / this.scaling);\n      this.thresoldFBO.resize(w / this.scaling, h / this.scaling);\n\n      this.renderer.context.size(w / this.scaling, h / this.scaling, window.devicePixelRatio);\n      this.camera.projection = new SQR.ProjectionMatrix().perspective(70, aspect, 1, 1000);\n    }\n\n  }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.js"],"sourceRoot":""}